{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"C:\\\\Users\\\\tarasenko_ag\\\\Desktop\\\\blog\\\\MyBlog\\\\frontNextJs\\\\pages\\\\snippets\\\\index.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport React, { useEffect, useReducer, useState } from \"react\";\nimport { ApolloClient, InMemoryCache, gql } from '@apollo/client';\nimport Layout from '../../components/Layout.jsx'; //! REMOVE THIS LINE LATER\n\nprocess.env['NODE_TLS_REJECT_UNAUTHORIZED'] = 0; // ###############################################################\n// ###############################################################\n\nconst client = new ApolloClient({\n  uri: process.env.REACT_APP_GRAPH_API,\n  cache: new InMemoryCache()\n}); // ###############################################################\n// ###############################################################\n// This function gets called at build time\n\nexport async function getStaticProps() {\n  //destructure response to data obj\n  const {\n    data: {\n      snippets\n    }\n  } = await client.query({\n    query: gql`{ \n            snippets {\n                title\n                slug\n                tags\n                excerpt\n                createdAt\n              } \n        }`\n  }); //collecting all possible tags for snippets to pass them as default value\n\n  let tagsArray = [];\n  snippets.forEach(snippet => snippet.tags.forEach(tag => !tagsArray.includes(tag) && tagsArray.push(tag)));\n  let newArr = [];\n  tagsArray.forEach(item => newArr.push({\n    tag: item,\n    isActive: true,\n    isSelected: false\n  }));\n  const initialContent = {\n    snippets: snippets,\n    filter: newArr,\n    allTags: tagsArray,\n    defaultFilter: newArr\n  };\n  return {\n    props: initialContent\n  };\n}\nconst ACTIONS = {\n  ADD_FILTER: 'add',\n  REMOVE_FILTER: 'remove',\n  TEST: 'test',\n  RESET: 'reset'\n};\n\nfunction reducer(content, action) {\n  const initState = content.allSnippets; //all 8 items\n\n  console.log(\"-- Reducer, CONTENT CURRENT --\", content.snippets);\n\n  switch (action.type) {\n    case ACTIONS.ADD_FILTER:\n      {\n        console.log(\"-- Reducer, ADD --\");\n        const updatedFilter = content.filter.map(item => item.tag === action.payload.tag ? _objectSpread(_objectSpread({}, item), {}, {\n          isSelected: true\n        }) : _objectSpread({}, item));\n        const updatedSnippets = filterSnippets();\n        console.log(\"Adding to current state: \", updatedSnippets.length);\n        return _objectSpread(_objectSpread({}, content), {}, {\n          filter: updatedFilter,\n          snippets: updatedSnippets\n        });\n      }\n\n    case ACTIONS.REMOVE_FILTER:\n      {\n        console.log(\"-- Reducer, REMOVE --\");\n        const updatedFilter = content.filter.map(item => item.tag === action.payload.tag ? _objectSpread(_objectSpread({}, item), {}, {\n          isSelected: false\n        }) : _objectSpread({}, item));\n        const updatedSnippets = filterSnippets();\n        return _objectSpread(_objectSpread({}, content), {}, {\n          filter: updatedFilter,\n          snippets: updatedSnippets\n        });\n      }\n\n    case ACTIONS.TEST:\n      {\n        const temp = filterSnippets();\n        return _objectSpread(_objectSpread({}, content), {}, {\n          snippets: temp\n        });\n      }\n\n    case ACTIONS.RESET:\n      {\n        return _objectSpread(_objectSpread({}, content), {}, {\n          snippets: initState,\n          filter: content.defaultFilter\n        });\n      }\n  }\n\n  function filterSnippets() {\n    const activeTags = content.filter.reduce((arr, item) => item.isSelected ? [...arr, item.tag] : arr, []);\n    const newSnippets = initState.reduce((arr, snippet) => {\n      activeTags.forEach(tag => {\n        if (snippet.tags.includes(tag) && !arr.some(item => item.slug === snippet.slug)) {\n          arr.push(snippet);\n        }\n      });\n      return arr;\n    }, []);\n    console.log(\"filterSnippets -> tags\", activeTags);\n    console.log(\"filterSnippets -> res arr\", newSnippets);\n    return newSnippets;\n  }\n} // ###############################################################npm\n// ###############################################################\n//! AllTags \\ allSnippets - probably not needed...\n\n\nfunction Index({\n  snippets,\n  filter,\n  allTags,\n  defaultFilter\n}) {\n  const {\n    0: content,\n    1: dispatch\n  } = useReducer(reducer, {\n    snippets,\n    filter,\n    allTags,\n    defaultFilter,\n    allSnippets: [...snippets]\n  });\n  console.group('State');\n  const snipTitles = content.snippets.map(item => item.title);\n  console.log(\"Snippets: \", content.snippets.length, snipTitles);\n  console.log(\"Filter: \", content.filter);\n  console.groupEnd();\n\n  function handleFiltering(e) {\n    if (e.target.classList.contains(\"selected\")) {\n      console.log(\"Disabling filter..\");\n      dispatch({\n        type: ACTIONS.REMOVE_FILTER,\n        payload: {\n          tag: e.target.value\n        }\n      });\n      return;\n    } else {\n      console.log(\"Adding new filter\");\n      dispatch({\n        type: ACTIONS.ADD_FILTER,\n        payload: {\n          tag: e.target.value\n        }\n      });\n      return;\n    }\n\n    ;\n  }\n\n  return /*#__PURE__*/_jsxDEV(React.Fragment, {\n    children: /*#__PURE__*/_jsxDEV(Layout, {\n      children: /*#__PURE__*/_jsxDEV(React.Fragment, {\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex flex-column mb-6 flex flex-col\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"px-64\",\n            children: [/*#__PURE__*/_jsxDEV(\"p\", {\n              children: \"Nay whatever way delicate passed of avoid might sing whatever all window concealed. Dissuade whole many age mistress late sentiments held doubt scarcely against invitation answer enable. Visited engage steepest shall beyond subject civilly performed concluded offence farther.\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 134,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"tags-filter flex flex-row mt-6\",\n              children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                className: \"tag px-2 py-1 border mr-2\",\n                onClick: () => dispatch({\n                  type: ACTIONS.RESET\n                }),\n                children: \"RESET\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 136,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                className: \"tag px-2 py-1 border\",\n                onClick: () => dispatch({\n                  type: ACTIONS.TEST\n                }),\n                children: \"TEST\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 137,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"mx-5\",\n                children: \" --- \"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 138,\n                columnNumber: 33\n              }, this), content.filter && content.filter.map((filter, index) => /*#__PURE__*/_jsxDEV(\"button\", {\n                className: `tag px-2 py-1 border mr-2 ${filter.isSelected ? 'selected' : ''}`,\n                disabled: !filter.isActive,\n                onClick: handleFiltering,\n                value: filter.tag,\n                children: filter.tag\n              }, index, false, {\n                fileName: _jsxFileName,\n                lineNumber: 142,\n                columnNumber: 94\n              }, this))]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 135,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 133,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"pt-8 flex flex-row flex-wrap items-stretch\",\n            children: content.snippets && content.snippets.map((snippet, index) => /*#__PURE__*/_jsxDEV(Snippet, {\n              snippet: snippet,\n              tags: snippet.tags\n            }, index, false, {\n              fileName: _jsxFileName,\n              lineNumber: 154,\n              columnNumber: 37\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 150,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 132,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 131,\n        columnNumber: 21\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 17\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 129,\n    columnNumber: 13\n  }, this);\n}\n\nconst Snippet = props => {\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"p-2 flex-shring-0 w-1/4 flex\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-gray-200 p-3\",\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          className: \"pb-2 text-lg leading-5\",\n          children: /*#__PURE__*/_jsxDEV(\"a\", {\n            href: `snippets/${props.snippet.slug}`,\n            children: props.snippet.title\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 168,\n            columnNumber: 56\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 168,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-sm leading-4\",\n          children: props.snippet.excerpt\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 169,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"snippet-tags flex flex-row pt-2 flex-wrap\",\n          children: props.tags.map((tag, index) => /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"snippet-tag text-sm flex-shrink-0\",\n            children: tag\n          }, index, false, {\n            fileName: _jsxFileName,\n            lineNumber: 171,\n            columnNumber: 53\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 170,\n          columnNumber: 17\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 167,\n        columnNumber: 13\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 166,\n      columnNumber: 9\n    }, this)\n  }, void 0, false);\n};\n\nexport default Index;","map":{"version":3,"sources":["C:/Users/tarasenko_ag/Desktop/blog/MyBlog/frontNextJs/pages/snippets/index.js"],"names":["React","useEffect","useReducer","useState","ApolloClient","InMemoryCache","gql","Layout","process","env","client","uri","REACT_APP_GRAPH_API","cache","getStaticProps","data","snippets","query","tagsArray","forEach","snippet","tags","tag","includes","push","newArr","item","isActive","isSelected","initialContent","filter","allTags","defaultFilter","props","ACTIONS","ADD_FILTER","REMOVE_FILTER","TEST","RESET","reducer","content","action","initState","allSnippets","console","log","type","updatedFilter","map","payload","updatedSnippets","filterSnippets","length","temp","activeTags","reduce","arr","newSnippets","some","slug","Index","dispatch","group","snipTitles","title","groupEnd","handleFiltering","e","target","classList","contains","value","index","Snippet","excerpt"],"mappings":"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","sourcesContent":["import React, { useEffect, useReducer, useState } from \"react\";\r\nimport { ApolloClient, InMemoryCache, gql } from '@apollo/client';\r\nimport Layout from '../../components/Layout.jsx';\r\n\r\n\r\n//! REMOVE THIS LINE LATER\r\nprocess.env['NODE_TLS_REJECT_UNAUTHORIZED'] = 0;\r\n\r\n// ###############################################################\r\n// ###############################################################\r\nconst client = new ApolloClient({\r\n    uri: process.env.REACT_APP_GRAPH_API,\r\n    cache: new InMemoryCache()\r\n});\r\n\r\n// ###############################################################\r\n// ###############################################################\r\n// This function gets called at build time\r\nexport async function getStaticProps() {\r\n    //destructure response to data obj\r\n    const { data: {snippets} } = await client.query({\r\n        query: gql`{ \r\n            snippets {\r\n                title\r\n                slug\r\n                tags\r\n                excerpt\r\n                createdAt\r\n              } \r\n        }`\r\n    });\r\n\r\n    //collecting all possible tags for snippets to pass them as default value\r\n    let tagsArray = []\r\n    snippets.forEach(snippet => snippet.tags.forEach(tag => !tagsArray.includes(tag) && tagsArray.push(tag)));\r\n\r\n    let newArr = [];\r\n    tagsArray.forEach(item => newArr.push({tag: item, isActive: true, isSelected: false}));\r\n    const initialContent = { snippets: snippets, filter: newArr, allTags: tagsArray, defaultFilter: newArr }\r\n\r\n    return { props: initialContent};\r\n  }\r\n\r\n\r\nconst ACTIONS = {\r\n    ADD_FILTER: 'add',\r\n    REMOVE_FILTER: 'remove',\r\n    TEST: 'test',\r\n    RESET: 'reset'\r\n  }\r\n\r\nfunction reducer(content, action) {\r\n    const initState = content.allSnippets; //all 8 items\r\n    console.log(\"-- Reducer, CONTENT CURRENT --\", content.snippets)\r\n    \r\n    switch(action.type) {\r\n        case ACTIONS.ADD_FILTER: {\r\n            console.log(\"-- Reducer, ADD --\")\r\n            const updatedFilter = content.filter.map( item => item.tag === action.payload.tag ? {...item, isSelected: true} : {...item});\r\n            const updatedSnippets = filterSnippets();\r\n            console.log(\"Adding to current state: \", updatedSnippets.length)\r\n\r\n            return {...content, filter: updatedFilter, snippets: updatedSnippets}\r\n        }\r\n\r\n        case ACTIONS.REMOVE_FILTER: {\r\n            console.log(\"-- Reducer, REMOVE --\")\r\n            const updatedFilter = content.filter.map( item => item.tag === action.payload.tag ? {...item, isSelected: false} : {...item});\r\n            const updatedSnippets = filterSnippets();\r\n\r\n            return {...content, filter: updatedFilter, snippets: updatedSnippets}\r\n        }\r\n\r\n        case ACTIONS.TEST: {\r\n            const temp = filterSnippets();\r\n            return {...content, snippets: temp}\r\n        }\r\n\r\n        case ACTIONS.RESET: {\r\n            return {...content, snippets: initState, filter: content.defaultFilter}\r\n        }\r\n    }\r\n\r\n    function filterSnippets() {\r\n        const activeTags = content.filter.reduce( (arr, item) => item.isSelected ? [...arr, item.tag] : arr, [])\r\n\r\n        const newSnippets = initState.reduce( (arr, snippet) => { \r\n            activeTags.forEach( tag => {\r\n                if(snippet.tags.includes(tag) && (!arr.some(item => item.slug === snippet.slug))) {\r\n                    arr.push(snippet)\r\n                }\r\n            })\r\n            return arr;\r\n        }, [])\r\n\r\n        console.log(\"filterSnippets -> tags\", activeTags)\r\n        console.log(\"filterSnippets -> res arr\", newSnippets)\r\n\r\n        return newSnippets;\r\n    }\r\n}\r\n\r\n// ###############################################################npm\r\n// ###############################################################\r\n//! AllTags \\ allSnippets - probably not needed...\r\n\r\nfunction Index( {snippets, filter, allTags, defaultFilter} ) {\r\n    const [content, dispatch] = useReducer(reducer, {snippets, filter, allTags, defaultFilter, allSnippets: [...snippets]})\r\n\r\n    console.group('State');\r\n    const snipTitles = content.snippets.map(item => item.title)\r\n    console.log(\"Snippets: \", content.snippets.length, snipTitles);\r\n    console.log(\"Filter: \", content.filter);\r\n    console.groupEnd();\r\n\r\n    function handleFiltering(e) {\r\n\r\n        if(e.target.classList.contains(\"selected\")) {\r\n            console.log(\"Disabling filter..\");\r\n            dispatch({type: ACTIONS.REMOVE_FILTER, payload: {tag: e.target.value}});\r\n            return\r\n        } else {\r\n            console.log(\"Adding new filter\")\r\n            dispatch({type: ACTIONS.ADD_FILTER, payload: {tag: e.target.value}})\r\n            return\r\n        };\r\n    }\r\n   \r\n    return  <React.Fragment>\r\n                <Layout >\r\n                    <React.Fragment>\r\n                    <div className=\"flex flex-column mb-6 flex flex-col\">\r\n                        <div className=\"px-64\">\r\n                            <p>Nay whatever way delicate passed of avoid might sing whatever all window concealed. Dissuade whole many age mistress late sentiments held doubt scarcely against invitation answer enable. Visited engage steepest shall beyond subject civilly performed concluded offence farther.</p>\r\n                            <div className=\"tags-filter flex flex-row mt-6\">\r\n                                <button className=\"tag px-2 py-1 border mr-2\" onClick={ () => dispatch({type: ACTIONS.RESET})} >RESET</button>\r\n                                <button className=\"tag px-2 py-1 border\" onClick={ () => dispatch({type: ACTIONS.TEST})} >TEST</button>\r\n                                <p className=\"mx-5\"> --- </p>\r\n                                {/* <p>Filters</p> */}\r\n                                {/* <button className=\"tag px-2 py-1 border mr-2\" onClick={sortSnippets} value={filter[prop]}> */}\r\n                                {\r\n                                    content.filter && content.filter.map( (filter, index) => <button className={`tag px-2 py-1 border mr-2 ${filter.isSelected ? 'selected' : ''}`}\r\n                                        disabled={!filter.isActive} key={index} onClick={handleFiltering} value={filter.tag} >\r\n                                            {filter.tag}\r\n                                        </button>\r\n                                    )\r\n                                }\r\n                            </div>\r\n                        </div>\r\n                        <div className=\"pt-8 flex flex-row flex-wrap items-stretch\">\r\n                            {/* <p>Snippet</p><p>Snippet</p><p>Snippet</p> */}\r\n                            {\r\n                                content.snippets && content.snippets.map( (snippet, index) => \r\n                                    <Snippet snippet={snippet} key={index} tags={snippet.tags} />\r\n                                )\r\n                            }\r\n                        </div>\r\n                    </div>\r\n                    </React.Fragment>\r\n                </Layout>\r\n            </React.Fragment>\r\n}\r\n\r\nconst Snippet = (props) => {\r\n    return <>\r\n        <div className=\"p-2 flex-shring-0 w-1/4 flex\" >\r\n            <div className=\"bg-gray-200 p-3\">\r\n                <h2 className=\"pb-2 text-lg leading-5\"><a href={`snippets/${props.snippet.slug}`}>{props.snippet.title}</a></h2>\r\n                <p className=\"text-sm leading-4\">{props.snippet.excerpt}</p>\r\n                <span className=\"snippet-tags flex flex-row pt-2 flex-wrap\">\r\n                    {props.tags.map((tag, index) => <p key={index} className=\"snippet-tag text-sm flex-shrink-0\">{tag}</p>)}\r\n                </span>\r\n            </div>\r\n        </div>\r\n    </>\r\n}\r\n\r\nexport default Index;"]},"metadata":{},"sourceType":"module"}