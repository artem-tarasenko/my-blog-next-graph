{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport _toConsumableArray from \"C:/Users/tarasenko_ag/Desktop/blog/MyBlog/frontNextJs/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _defineProperty from \"C:/Users/tarasenko_ag/Desktop/blog/MyBlog/frontNextJs/node_modules/@babel/runtime/helpers/esm/defineProperty\";\n\nvar _jsxFileName = \"C:\\\\Users\\\\tarasenko_ag\\\\Desktop\\\\blog\\\\MyBlog\\\\frontNextJs\\\\pages\\\\snippets\\\\index.js\",\n    _s = $RefreshSig$();\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useEffect, useReducer, useState } from \"react\";\nimport Layout from '../../components/Layout.jsx'; //! REMOVE THIS LINE LATER\n\nprocess.env['NODE_TLS_REJECT_UNAUTHORIZED'] = 0; // ###############################################################\n// ###############################################################\n\nvar ACTIONS = {\n  ADD_FILTER: 'add',\n  REMOVE_FILTER: 'remove'\n};\n\nfunction reducer(content, action) {\n  var tag = content.tag,\n      filter = content.filter,\n      snippets = content.snippets;\n  console.log(\"reducer state\", content);\n  console.log(\"reducer action\", action);\n  console.log(\"reducer Filter result: \", filter.some(function (item) {\n    return item.isActive;\n  }));\n  var isFirstFilter = true;\n\n  function testFilters() {\n    // content.filter.forEach(tag => {\n    //     if(!tag.isActive) {\n    //         isFirstFilter = false;\n    //     }\n    // })\n    filter.some(function (item) {\n      return item.isActive;\n    });\n  }\n\n  function getSnippetsTags(array) {\n    var tagsArray = []; //just tags\n\n    array.forEach(function (snippet) {\n      return snippet.tags.forEach(function (tag) {\n        return !tagsArray.includes(tag) && tagsArray.push(tag);\n      });\n    });\n    var disabledFilter = content.filter.map(function (item) {\n      return _objectSpread(_objectSpread({}, item), {}, {\n        isActive: false\n      });\n    });\n    var updatedFilter = disabledFilter.map(function (item) {\n      if (tagsArray.includes(item.tag)) {\n        return _objectSpread(_objectSpread({}, item), {}, {\n          isActive: true\n        });\n      } else {\n        return item;\n      }\n    });\n    console.group('Reducer - get snippets tags');\n    console.log(\"Initial array: \", array);\n    console.log(\"Tags filtered \", tagsArray);\n    console.log(\"Disabled array: \", disabledFilter);\n    console.log(\"Updated array: \", updatedFilter);\n    console.groupEnd(); // let newArr = []; //tag objets\n    // tagsArray.forEach(item => newArr.push({tag: item, isActive: true, isSelected: false}));\n\n    return updatedFilter;\n  } //###1st test- Adding or removing filter\n\n\n  if (!action.button.classList.contains(\"selected\")) {\n    //no class - ADDING\n    //###2 test 1st lvl or 2+\n    testFilters();\n    action.button.classList.add(\"selected\");\n\n    if (isFirstFilter) {\n      //filter snippets to a [tag] - newSnippets-1 (could be not new array but resulting after filtering for selected)\n      console.log(\"Reducer - value:\", action.button.value);\n      var newSnippets = content.snippets.filter(function (item) {\n        return item.tags.includes(action.button.value);\n      });\n      console.log(\"Reducer - FILTERING Snippets result:\", newSnippets); //get all tags from newSnippets-1 and update TAGS \n\n      var newFilter = getSnippetsTags(newSnippets); // res => half tags active, 1 selected\n\n      console.log(\"Reducer result test: \", _objectSpread(_objectSpread({}, content), {}, {\n        snippets: newSnippets\n      }));\n      return _objectSpread(_objectSpread({}, content), {}, {\n        snippets: newSnippets,\n        filter: newFilter\n      });\n    } else {\n      //set target tag isSelected\n      var _newSnippets = content.snippets.filter.filter(function (item) {\n        return item.tags.includes(action.button.value);\n      }); // filter newSnippets-1 (or just snippets) to [TAG1, TAG2] with func\n      // (could be not new array but resulting after filtering for selected)\n      // get all tags from newSnippets (could be just 1 snippet already) and Update tags\n      // res => 2 selecetd tags and a few active\n\n    }\n  } else {// with class - REMOVING\n      //2 test 1st lvl or 2+\n      // if TAGS(item has item.isSelected = 1) - NO - them 1st\n      //get default snippets to render\n      //reset TAGS - all to isActive and notSelected\n      //res => all to defaults\n      // if TAGS(item has item.isSelected 2+ ) - them 2nd+\n      //set target tag isSelected=false - \n      //update tags array\n      //filter snippets with new TAGS array by selected\n      //update TAGS from snippets and set needed to isActive\n      //res => TAGS with -1 selected, half active\n    }\n} // ###############################################################npm\n// ###############################################################\n\n\nfunction Index(_ref) {\n  _s();\n\n  var _this = this;\n\n  var snippets = _ref.snippets,\n      filter = _ref.filter,\n      allTags = _ref.allTags,\n      defaultFilter = _ref.defaultFilter;\n\n  var _useReducer = useReducer(reducer, {\n    snippets: snippets,\n    filter: filter,\n    allTags: allTags,\n    defaultFilter: defaultFilter\n  }),\n      content = _useReducer[0],\n      dispatch = _useReducer[1]; // function reducer(exportState, action) {\n  //     switch (action.type) {\n  //         case \"selected\": {\n  //             handleSelectTemplate(action.payload.target, action.payload.name) //clicked node and its title\n  //             return {...exportState, template: action.payload.name, state: {...exportState.state, isSelected: true}}\n  //             }\n  // const [exportState, dispatch] = useReducer(reducer, {template: \"\", code: appData.code, state: {isDone: false, isLoading: false, isSelected: false}})\n  //dispatch({type: 'selected', payload: {name: item?.name, target: e.target}})}\n\n\n  console.log(\"SNIPPETS > \", content.snippets);\n  console.log(\"FILTER > \", content.filter);\n\n  function sortByTag(e) {\n    console.log(\"###########################################################################\");\n    console.log(\"###########################################################################\");\n    console.group('Init sorting');\n    console.log(\"On Click # Snippets pressed\", e.target.value);\n    console.log(\"On Click # Snippets arr\", e.target.classList);\n    console.log(\"On click # event\", e.target);\n    console.groupEnd();\n    var filterValue = [];\n\n    if (e.target.classList.contains(\"selected\")) {\n      //DEACTIVATING FILTER\n      console.group('Deactivating...');\n      e.target.classList.remove(\"selected\"); //test whether filter had 1 tag or more\n\n      if (filter.length = 1) {\n        //resetting filter to default\n        console.group('Deselecting tag');\n        console.log(\"Removing last filter (filter length):\", filter.length);\n        setFilter(tags);\n        console.log(\"Resetting default filter (length):\", filter.length);\n        console.groupEnd();\n      } else {\n        //remove tag from filter\n        console.log(\"At least 2 filters, removing selected (init filterss, remove tag):\", filter, e.target.value);\n        setFilter(function (prevValue) {\n          return prevValue.filter(tag != e.target.value);\n        });\n        console.log(\"New filter value:\", filter);\n        console.groupEnd();\n      }\n    } else if (!e.target.classList.contains(\"selected\")) {\n      //ACTIVATING FILTER\n      console.group('Activating...');\n      e.target.classList.add(\"selected\"); //test whether filter was default or not\n\n      if (filter === tags) {\n        console.log(\"Filters are equal (tags, filter):\", tags.length, filter.length); //remove all filter data if filter=tags, add 1 selected\n        //rerender snippets\n\n        console.log(\"Updating filter, should be 1 item only\");\n        setFilter([e.target.value]);\n        console.log(\"New filter value:\", filter);\n        console.groupEnd();\n      } else {\n        console.log(\"Filters are NOT equal (tags, filter):\", tags.length, filter.length);\n        setFilter(function (prevValue) {\n          return [].concat(_toConsumableArray(prevValue), [e.target.value]);\n        });\n        console.log(\"New filter value:\", filter);\n        console.groupEnd();\n      } //reset filter if 1 only was selected\n      //remove selected if 2+ were selected\n      //rerender snippets\n\n    } // const filteredArray = snippetsArray.filter(item => item.tags.includes(e.target.value));\n    // console.log(\"On click # filtered array of snippets: \", filteredArray);\n    // setSnippetsArray(filteredArray);\n\n  }\n\n  function sortByTag2(e) {\n    dispatch({\n      button: e.target\n    });\n  }\n\n  function initTags() {\n    //collecting all possible tags for CURRENT snippets to pass them as default value\n    //allTags - all possible from SSR stage\n    var sortedTags = [];\n    snippetsArray.forEach(function (snippet) {\n      return snippet.tags.forEach(function (tag) {\n        return !sortedTags.includes(tag) && sortedTags.push(tag);\n      });\n    }); // console.log(\"ARR\", tagsArray.map(tag => { return {tag: tag, isActive: true}}))\n\n    var newSortedArr = [];\n    sortedTags.forEach(function (item) {\n      return newSortedArr.push({\n        tag: item,\n        state: true\n      });\n    });\n    setFilter(newSortedArr);\n  }\n\n  function sortSnippets(e) {\n    console.log(\"click\", e.target); //const targetTagStatus = ((filter.find(item => item.tag === e.target.value).state));\n\n    var updatedFilter = filter.map(function (obj) {\n      return obj.tag === e.target.value ? _objectSpread(_objectSpread({}, obj), {}, {\n        state: !obj.state\n      }) : obj;\n    });\n    console.log(updatedFilter);\n    initTags();\n    setFilter(updatedFilter);\n  }\n\n  return /*#__PURE__*/_jsxDEV(React.Fragment, {\n    children: /*#__PURE__*/_jsxDEV(Layout, {\n      children: /*#__PURE__*/_jsxDEV(React.Fragment, {\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex flex-column mb-6 flex flex-col\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"px-64\",\n            children: [/*#__PURE__*/_jsxDEV(\"p\", {\n              children: \"Nay whatever way delicate passed of avoid might sing whatever all window concealed. Dissuade whole many age mistress late sentiments held doubt scarcely against invitation answer enable. Visited engage steepest shall beyond subject civilly performed concluded offence farther.\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 266,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"tags-filter flex flex-row mt-6\",\n              children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                className: \"tag px-2 py-1 border mr-2\",\n                children: \"TEST\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 268,\n                columnNumber: 33\n              }, this), content.filter.map(function (filter, index) {\n                return /*#__PURE__*/_jsxDEV(\"button\", {\n                  className: \"tag px-2 py-1 border mr-2 deactivated\",\n                  disabled: !filter.isActive,\n                  onClick: sortByTag2,\n                  value: filter.tag,\n                  children: filter.tag\n                }, index, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 271,\n                  columnNumber: 76\n                }, _this);\n              })]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 267,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 265,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"pt-8 flex flex-row flex-wrap items-stretch\",\n            children: content.snippets.map(function (snippet) {\n              return /*#__PURE__*/_jsxDEV(_Fragment, {\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"p-2 flex-shring-0 w-1/4 flex\",\n                  children: /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"bg-gray-200 p-3\",\n                    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n                      className: \"pb-2 text-lg leading-5\",\n                      children: /*#__PURE__*/_jsxDEV(\"a\", {\n                        href: \"snippets/\".concat(snippet.slug),\n                        children: snippet.title\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 284,\n                        columnNumber: 76\n                      }, _this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 284,\n                      columnNumber: 37\n                    }, _this), /*#__PURE__*/_jsxDEV(\"p\", {\n                      className: \"text-sm leading-4\",\n                      children: snippet.excerpt\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 285,\n                      columnNumber: 37\n                    }, _this), /*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"snippet-tags flex flex-row pt-2 flex-wrap\",\n                      children: snippet.tags.map(function (tag) {\n                        return /*#__PURE__*/_jsxDEV(\"p\", {\n                          className: \"snippet-tag text-sm flex-shrink-0\",\n                          children: tag\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 287,\n                          columnNumber: 66\n                        }, _this);\n                      })\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 286,\n                      columnNumber: 37\n                    }, _this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 283,\n                    columnNumber: 33\n                  }, _this)\n                }, snippet.id, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 282,\n                  columnNumber: 29\n                }, _this)\n              }, void 0, false);\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 279,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 264,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 263,\n        columnNumber: 21\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 262,\n      columnNumber: 17\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 261,\n    columnNumber: 13\n  }, this);\n}\n\n_s(Index, \"F1AtsVV4ULpNcYE0o/xU8iHaLeg=\");\n\n_c = Index;\nexport var __N_SSG = true;\nexport default Index;\n\nvar _c;\n\n$RefreshReg$(_c, \"Index\");","map":{"version":3,"sources":["C:/Users/tarasenko_ag/Desktop/blog/MyBlog/frontNextJs/pages/snippets/index.js"],"names":["React","useEffect","useReducer","useState","Layout","process","env","ACTIONS","ADD_FILTER","REMOVE_FILTER","reducer","content","action","tag","filter","snippets","console","log","some","item","isActive","isFirstFilter","testFilters","getSnippetsTags","array","tagsArray","forEach","snippet","tags","includes","push","disabledFilter","map","updatedFilter","group","groupEnd","button","classList","contains","add","value","newSnippets","newFilter","Index","allTags","defaultFilter","dispatch","sortByTag","e","target","filterValue","remove","length","setFilter","prevValue","sortByTag2","initTags","sortedTags","snippetsArray","newSortedArr","state","sortSnippets","obj","index","slug","title","excerpt","id"],"mappings":"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","sourcesContent":["import React, { useEffect, useReducer, useState } from \"react\";\r\nimport { ApolloClient, InMemoryCache, gql } from '@apollo/client';\r\nimport Layout from '../../components/Layout.jsx';\r\n\r\n\r\n//! REMOVE THIS LINE LATER\r\nprocess.env['NODE_TLS_REJECT_UNAUTHORIZED'] = 0;\r\n\r\n// ###############################################################\r\n// ###############################################################\r\nconst client = new ApolloClient({\r\n    uri: process.env.REACT_APP_GRAPH_API,\r\n    cache: new InMemoryCache()\r\n});\r\n\r\n// ###############################################################\r\n// ###############################################################\r\n// This function gets called at build time\r\nexport async function getStaticProps() {\r\n    //destructure response to data obj\r\n    const { data: {snippets} } = await client.query({\r\n        query: gql`{ \r\n            snippets {\r\n                title\r\n                slug\r\n                tags\r\n                excerpt\r\n                createdAt\r\n              } \r\n        }`\r\n    });\r\n\r\n    //collecting all possible tags for snippets to pass them as default value\r\n    let tagsArray = []\r\n    snippets.forEach(snippet => snippet.tags.forEach(tag => !tagsArray.includes(tag) && tagsArray.push(tag)));\r\n\r\n    let newArr = [];\r\n    tagsArray.forEach(item => newArr.push({tag: item, isActive: true, isSelected: false}));\r\n    const initialContent = { snippets: snippets, filter: newArr, allTags: tagsArray, defaultFilter: newArr }\r\n\r\n    return { props: initialContent};\r\n  }\r\n\r\n\r\nconst ACTIONS = {\r\n    ADD_FILTER: 'add',\r\n    REMOVE_FILTER: 'remove',\r\n  }\r\n\r\nfunction reducer(content, action) {\r\n    const { tag, filter, snippets} = content;\r\n\r\n    console.log(\"reducer state\", content);\r\n    console.log(\"reducer action\", action);\r\n    console.log(\"reducer Filter result: \", filter.some( item => item.isActive))\r\n\r\n    let isFirstFilter = true;\r\n\r\n    function testFilters() {\r\n        // content.filter.forEach(tag => {\r\n        //     if(!tag.isActive) {\r\n        //         isFirstFilter = false;\r\n        //     }\r\n        // })\r\n\r\n        filter.some( item => item.isActive)\r\n    }\r\n\r\n    function getSnippetsTags(array) {\r\n        let tagsArray = [] //just tags\r\n        array.forEach(snippet => snippet.tags.forEach(tag => !tagsArray.includes(tag) && tagsArray.push(tag)));\r\n        const disabledFilter = content.filter.map( item => ({...item, isActive: false}) )\r\n        const updatedFilter = disabledFilter.map( item => {\r\n            if(tagsArray.includes(item.tag)) {\r\n                return {...item, isActive: true};\r\n            } else {\r\n                return item;\r\n            }\r\n        })\r\n\r\n        console.group('Reducer - get snippets tags');\r\n        console.log(\"Initial array: \", array);\r\n        console.log(\"Tags filtered \", tagsArray);\r\n        console.log(\"Disabled array: \", disabledFilter);\r\n        console.log(\"Updated array: \", updatedFilter);\r\n        console.groupEnd();\r\n\r\n        // let newArr = []; //tag objets\r\n        // tagsArray.forEach(item => newArr.push({tag: item, isActive: true, isSelected: false}));\r\n        \r\n        return updatedFilter;\r\n    }\r\n\r\n    //###1st test- Adding or removing filter\r\n    if(!action.button.classList.contains(\"selected\")) { //no class - ADDING\r\n        //###2 test 1st lvl or 2+\r\n        testFilters();\r\n        action.button.classList.add(\"selected\");\r\n\r\n        if(isFirstFilter) {\r\n            //filter snippets to a [tag] - newSnippets-1 (could be not new array but resulting after filtering for selected)\r\n            console.log(\"Reducer - value:\", action.button.value);\r\n            const newSnippets = content.snippets.filter(item => item.tags.includes(action.button.value));\r\n            console.log(\"Reducer - FILTERING Snippets result:\", newSnippets);\r\n\r\n            //get all tags from newSnippets-1 and update TAGS \r\n            let newFilter = getSnippetsTags(newSnippets);\r\n            \r\n\r\n                // res => half tags active, 1 selected\r\n            console.log(\"Reducer result test: \", {...content, snippets: newSnippets});\r\n            return {...content, snippets: newSnippets, filter: newFilter};\r\n            \r\n        } else {\r\n            //set target tag isSelected\r\n            const newSnippets = content.snippets.filter   .filter(item => item.tags.includes(action.button.value));\r\n            // filter newSnippets-1 (or just snippets) to [TAG1, TAG2] with func\r\n            // (could be not new array but resulting after filtering for selected)\r\n            // get all tags from newSnippets (could be just 1 snippet already) and Update tags\r\n                // res => 2 selecetd tags and a few active\r\n        }\r\n    } else {// with class - REMOVING\r\n    //2 test 1st lvl or 2+\r\n        // if TAGS(item has item.isSelected = 1) - NO - them 1st\r\n            //get default snippets to render\r\n            //reset TAGS - all to isActive and notSelected\r\n            //res => all to defaults\r\n\r\n        // if TAGS(item has item.isSelected 2+ ) - them 2nd+\r\n            //set target tag isSelected=false - \r\n            //update tags array\r\n            //filter snippets with new TAGS array by selected\r\n            //update TAGS from snippets and set needed to isActive\r\n            //res => TAGS with -1 selected, half active\r\n        \r\n\r\n    }\r\n\r\n\r\n\r\n}\r\n\r\n// ###############################################################npm\r\n// ###############################################################\r\nfunction Index( {snippets, filter, allTags, defaultFilter} ) {\r\n    const [content, dispatch] = useReducer(reducer, {snippets, filter, allTags, defaultFilter})\r\n\r\n    // function reducer(exportState, action) {\r\n    //     switch (action.type) {\r\n    //         case \"selected\": {\r\n    //             handleSelectTemplate(action.payload.target, action.payload.name) //clicked node and its title\r\n    //             return {...exportState, template: action.payload.name, state: {...exportState.state, isSelected: true}}\r\n    //             }\r\n\r\n\r\n    // const [exportState, dispatch] = useReducer(reducer, {template: \"\", code: appData.code, state: {isDone: false, isLoading: false, isSelected: false}})\r\n\r\n    //dispatch({type: 'selected', payload: {name: item?.name, target: e.target}})}\r\n\r\n\r\n    console.log(\"SNIPPETS > \", content.snippets);\r\n    console.log(\"FILTER > \", content.filter);\r\n\r\n\r\n    function sortByTag(e) {\r\n        console.log(\"###########################################################################\");\r\n        console.log(\"###########################################################################\");\r\n        console.group('Init sorting');\r\n            console.log(\"On Click # Snippets pressed\", e.target.value);\r\n            console.log(\"On Click # Snippets arr\", e.target.classList);\r\n            console.log(\"On click # event\", e.target);\r\n        console.groupEnd();\r\n\r\n        let filterValue = [];\r\n\r\n\r\n\r\n        if(e.target.classList.contains(\"selected\")) {\r\n            //DEACTIVATING FILTER\r\n            console.group('Deactivating...');\r\n            e.target.classList.remove(\"selected\");\r\n            //test whether filter had 1 tag or more\r\n            if(filter.length = 1) {\r\n                //resetting filter to default\r\n                console.group('Deselecting tag');\r\n                console.log(\"Removing last filter (filter length):\", filter.length);\r\n                setFilter(tags);\r\n                console.log(\"Resetting default filter (length):\", filter.length);\r\n                console.groupEnd();\r\n            } else {\r\n                //remove tag from filter\r\n                console.log(\"At least 2 filters, removing selected (init filterss, remove tag):\", filter, e.target.value);\r\n                \r\n                setFilter(prevValue => prevValue.filter( tag != e.target.value))\r\n                console.log(\"New filter value:\", filter);\r\n                console.groupEnd();\r\n            }\r\n\r\n        } else if(!e.target.classList.contains(\"selected\")) {\r\n            //ACTIVATING FILTER\r\n            console.group('Activating...');\r\n            e.target.classList.add(\"selected\");\r\n\r\n            //test whether filter was default or not\r\n            if(filter === tags) {\r\n                console.log(\"Filters are equal (tags, filter):\", tags.length, filter.length);\r\n                //remove all filter data if filter=tags, add 1 selected\r\n                //rerender snippets\r\n                console.log(\"Updating filter, should be 1 item only\");\r\n                setFilter([e.target.value]);\r\n                console.log(\"New filter value:\", filter);\r\n                console.groupEnd();\r\n\r\n            } else {\r\n                console.log(\"Filters are NOT equal (tags, filter):\", tags.length, filter.length);\r\n                \r\n                setFilter(prevValue => [...prevValue, e.target.value])\r\n                console.log(\"New filter value:\", filter);\r\n                console.groupEnd();\r\n            }\r\n            //reset filter if 1 only was selected\r\n            //remove selected if 2+ were selected\r\n            //rerender snippets\r\n        }\r\n        \r\n\r\n        \r\n\r\n        // const filteredArray = snippetsArray.filter(item => item.tags.includes(e.target.value));\r\n        // console.log(\"On click # filtered array of snippets: \", filteredArray);\r\n        // setSnippetsArray(filteredArray);\r\n    }\r\n\r\n    function sortByTag2(e) {\r\n        dispatch( {button: e.target} )\r\n    }\r\n\r\n    function initTags() {\r\n        //collecting all possible tags for CURRENT snippets to pass them as default value\r\n        //allTags - all possible from SSR stage\r\n        let sortedTags = []\r\n        snippetsArray.forEach(snippet => snippet.tags.forEach(tag => !sortedTags.includes(tag) && sortedTags.push(tag)));\r\n        // console.log(\"ARR\", tagsArray.map(tag => { return {tag: tag, isActive: true}}))\r\n\r\n        let newSortedArr = [];\r\n        sortedTags.forEach( item => newSortedArr.push({tag: item, state: true}))\r\n        setFilter(newSortedArr)\r\n    }\r\n\r\n    function sortSnippets(e) {\r\n        console.log(\"click\", e.target);\r\n        //const targetTagStatus = ((filter.find(item => item.tag === e.target.value).state));\r\n\r\n        const updatedFilter = filter.map( obj => obj.tag === e.target.value ? ({...obj, state: !obj.state}) : obj);\r\n        console.log(updatedFilter);\r\n\r\n        initTags();\r\n        setFilter(updatedFilter);\r\n    }\r\n    \r\n    return  <React.Fragment>\r\n                <Layout >\r\n                    <React.Fragment>\r\n                    <div className=\"flex flex-column mb-6 flex flex-col\">\r\n                        <div className=\"px-64\">\r\n                            <p>Nay whatever way delicate passed of avoid might sing whatever all window concealed. Dissuade whole many age mistress late sentiments held doubt scarcely against invitation answer enable. Visited engage steepest shall beyond subject civilly performed concluded offence farther.</p>\r\n                            <div className=\"tags-filter flex flex-row mt-6\">\r\n                                <button className=\"tag px-2 py-1 border mr-2\" >TEST</button>\r\n                                {/* <button className=\"tag px-2 py-1 border mr-2\" onClick={sortSnippets} value={filter[prop]}> */}\r\n                                {\r\n                                    content.filter.map( (filter, index) => <button className=\"tag px-2 py-1 border mr-2 deactivated\"\r\n                                        disabled={!filter.isActive} key={index}  onClick={sortByTag2} value={filter.tag} >\r\n                                            {filter.tag}\r\n                                        </button>\r\n                                    )\r\n                                }\r\n                            </div>\r\n                        </div>\r\n                        <div className=\"pt-8 flex flex-row flex-wrap items-stretch\">\r\n                            {content.snippets.map( snippet => \r\n                            <>\r\n                            <div key={snippet.id} className=\"p-2 flex-shring-0 w-1/4 flex\" >\r\n                                <div className=\"bg-gray-200 p-3\">\r\n                                    <h2 className=\"pb-2 text-lg leading-5\"><a href={`snippets/${snippet.slug}`}>{snippet.title}</a></h2>\r\n                                    <p className=\"text-sm leading-4\">{snippet.excerpt}</p>\r\n                                    <span className=\"snippet-tags flex flex-row pt-2 flex-wrap\">\r\n                                        {snippet.tags.map(tag => <p className=\"snippet-tag text-sm flex-shrink-0\">{tag}</p>)}\r\n                                    </span>\r\n                                </div>\r\n                            </div>\r\n                            </>\r\n                            )}\r\n                        </div>\r\n                    </div>\r\n                    </React.Fragment>\r\n                </Layout>\r\n            </React.Fragment>\r\n}\r\n\r\nexport default Index;"]},"metadata":{},"sourceType":"module"}